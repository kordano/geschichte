<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>replikativ.crdt.repo.stage documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Replikativ 0.1.0-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replikativ</span></div></div></li><li class="depth-2 branch"><a href="replikativ.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>crdt</span></div></div></li><li class="depth-3 branch"><a href="replikativ.crdt.materialize.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>materialize</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repo</span></div></div></li><li class="depth-4 branch"><a href="replikativ.crdt.repo.impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></a></li><li class="depth-4 branch"><a href="replikativ.crdt.repo.meta.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>meta</span></div></a></li><li class="depth-4 branch"><a href="replikativ.crdt.repo.realize.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>realize</span></div></a></li><li class="depth-4 branch"><a href="replikativ.crdt.repo.repo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repo</span></div></a></li><li class="depth-4 current"><a href="replikativ.crdt.repo.stage.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stage</span></div></a></li><li class="depth-3"><a href="replikativ.crdt.utils.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-2 branch"><a href="replikativ.environ.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>environ</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>p2p</span></div></div></li><li class="depth-3 branch"><a href="replikativ.p2p.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3 branch"><a href="replikativ.p2p.block-detector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>block-detector</span></div></a></li><li class="depth-3 branch"><a href="replikativ.p2p.fetch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fetch</span></div></a></li><li class="depth-3 branch"><a href="replikativ.p2p.hash.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hash</span></div></a></li><li class="depth-3 branch"><a href="replikativ.p2p.hooks.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hooks</span></div></a></li><li class="depth-3"><a href="replikativ.p2p.log.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>log</span></div></a></li><li class="depth-2 branch"><a href="replikativ.platform.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>platform</span></div></a></li><li class="depth-2 branch"><a href="replikativ.platform-data.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>platform-data</span></div></a></li><li class="depth-2 branch"><a href="replikativ.platform-log.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>platform-log</span></div></a></li><li class="depth-2 branch"><a href="replikativ.protocols.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-2"><a href="replikativ.stage.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stage</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var--.3EAbort"><div class="inner"><span>-&gt;Abort</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-abort-prepared"><div class="inner"><span>abort-prepared</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-branch.21"><div class="inner"><span>branch!</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-checkout.21"><div class="inner"><span>checkout!</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-commit.21"><div class="inner"><span>commit!</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-create-repo.21"><div class="inner"><span>create-repo!</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-fork.21"><div class="inner"><span>fork!</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-map-.3EAbort"><div class="inner"><span>map-&gt;Abort</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-merge.21"><div class="inner"><span>merge!</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-merge-cost"><div class="inner"><span>merge-cost</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-pull.21"><div class="inner"><span>pull!</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-remove-repos.21"><div class="inner"><span>remove-repos!</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-transact"><div class="inner"><span>transact</span></div></a></li><li class="depth-1"><a href="replikativ.crdt.repo.stage.html#var-transact-binary"><div class="inner"><span>transact-binary</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">replikativ.crdt.repo.stage</h2><div class="doc"><pre class="plaintext">Upstream interaction for repository CRDT with stage.
</pre></div><div class="public anchor" id="var--.3EAbort"><h3>-&gt;Abort</h3><div class="usage"><code>(-&gt;Abort new-value aborted)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class replikativ.crdt.repo.stage.Abort.
</pre></div></div><div class="public anchor" id="var-abort-prepared"><h3>abort-prepared</h3><div class="usage"><code>(abort-prepared stage [user repo branch])</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-branch.21"><h3>branch!</h3><div class="usage"><code>(branch! stage [user repo] branch-name parent-commit)</code></div><div class="doc"><pre class="plaintext">Create a new branch with tip parent-commit.
</pre></div></div><div class="public anchor" id="var-checkout.21"><h3>checkout!</h3><div class="usage"><code>(checkout! stage [user repo] branch)</code></div><div class="doc"><pre class="plaintext">Tries to check out one branch and waits until it is available.
This possibly blocks forever if the branch cannot be fetched from some peer.</pre></div></div><div class="public anchor" id="var-commit.21"><h3>commit!</h3><div class="usage"><code>(commit! stage repos)</code></div><div class="doc"><pre class="plaintext">Commit all branches synchronously on stage given by the repository map,
e.g. {user1 {repo1 #{branch1}} user2 {repo1 #{branch1 branch2}}}.
Returns go block to synchronize.</pre></div></div><div class="public anchor" id="var-create-repo.21"><h3>create-repo!</h3><div class="usage"><code>(create-repo! stage &amp; {:keys [user is-public? branch id description], :or {is-public? false, branch &quot;master&quot;, description &quot;&quot;}})</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-fork.21"><h3>fork!</h3><div class="usage"><code>(fork! stage [user repo-id branch] &amp; {:keys [into-user description is-public?], :or {is-public? false, description &quot;&quot;}})</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-map-.3EAbort"><h3>map-&gt;Abort</h3><div class="usage"><code>(map-&gt;Abort m__6289__auto__)</code></div><div class="doc"><pre class="plaintext">Factory function for class replikativ.crdt.repo.stage.Abort, taking a map of keywords to field values.
</pre></div></div><div class="public anchor" id="var-merge.21"><h3>merge!</h3><div class="usage"><code>(merge! stage [user repo branch] heads-order &amp; {:keys [wait? correcting-transactions], :or {wait? true, correcting-transactions []}})</code></div><div class="doc"><pre class="plaintext">Merge multiple heads in a branch of a repository. Use heads-order
to decide in which order commits contribute to the value. By adding
older commits before their parents, you can enforce to realize
them (and their past) first for this merge (commit-reordering). Only
reorder parts of the concurrent history, not of the sequential
common past. Returns go channel to synchronize.</pre></div></div><div class="public anchor" id="var-merge-cost"><h3>merge-cost</h3><div class="usage"><code>(merge-cost graph)</code></div><div class="doc"><pre class="plaintext">Estimates cost for adding a further merge to the repository by taking
the ratio between merges and normal commits of the commit-graph into account.</pre></div></div><div class="public anchor" id="var-pull.21"><h3>pull!</h3><div class="usage"><code>(pull! stage [remote-user repo branch] into-branch &amp; {:keys [into-user allow-induced-conflict? rebase-transactions?], :or {allow-induced-conflict? false, rebase-transactions? false}})</code></div><div class="doc"><pre class="plaintext">Pull from remote-user (can be the same), repo branch in into-branch.
Defaults to stage user as into-user. Returns go-block to synchronize.</pre></div></div><div class="public anchor" id="var-remove-repos.21"><h3>remove-repos!</h3><div class="usage"><code>(remove-repos! stage repos)</code></div><div class="doc"><pre class="plaintext">Remove repos map from stage, e.g. {user {repo-id #{branch1
branch2}}}. Returns go block to synchronize. TODO remove branches</pre></div></div><div class="public anchor" id="var-transact"><h3>transact</h3><div class="usage"><code>(transact stage [user repo branch] trans-fn-code params)</code><code>(transact stage [user repo branch] transactions)</code></div><div class="doc"><pre class="plaintext">Transact a transaction function trans-fn-code (given as quoted code: &apos;(fn [old params] (merge old params))) on previous value of user&apos;s repository branch and params.
THIS DOES NOT COMMIT YET, you have to call commit! explicitly afterwards. It can still abort resulting in a staged replikativ.stage.Abort value for the repository. Returns go block to synchronize.</pre></div></div><div class="public anchor" id="var-transact-binary"><h3>transact-binary</h3><div class="usage"><code>(transact-binary stage [user repo branch] blob)</code></div><div class="doc"><pre class="plaintext">Transact a binary blob to reference it later, this only prepares a transaction and does not commit.
This can support transacting files if the underlying store supports
this (FileSystemStore).</pre></div></div></div></body></html>